# Memos + Notion çŸ¥è¯†åº“æ¶æ„è®¾è®¡

> **é¡¹ç›®**: pubilie_doc çŸ¥è¯†åº“ç³»ç»Ÿ
> **ç‰ˆæœ¬**: 1.0.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-13
> **è®¾è®¡åè®®**: Ultrathink v2.7
> **é¢„æœŸæ•ˆæœ**: æ¯æ—¥5000+æ–‡ç« è‡ªåŠ¨å…¥åº“ã€æœ¬åœ°LLMå¤„ç†ã€çŸ¥è¯†å›¾è°±èåˆ

---

## ğŸ“‹ ç³»ç»Ÿæ¦‚è§ˆ

### è®¾è®¡ç›®æ ‡

| ç›®æ ‡ | æŒ‡æ ‡ | å®ç°æ–¹å¼ |
|------|------|----------|
| **å¤§è§„æ¨¡å…¥åº“** | 5000+ æ–‡ç« /å¤© | n8n æ‰¹é‡å·¥ä½œæµ + å¼‚æ­¥é˜Ÿåˆ— |
| **å¿«é€Ÿæ£€ç´¢** | <100ms æŸ¥è¯¢ | Memos å…¨æ–‡æœç´¢ + PostgreSQL ç´¢å¼• |
| **æœ¬åœ°LLMå¤„ç†** | éšç§ä¼˜å…ˆ | Macæœ¬æœº Ollama + Qwen3-14B |
| **çŸ¥è¯†å›¾è°±èåˆ** | å®ä½“å…³è” | Neo4j + Memos Tag ç³»ç»Ÿ |
| **å¤šç«¯åŒæ­¥** | éšæ—¶è®¿é—® | Notion äº‘ç«¯ + Memos æœ¬åœ° |

### æ¶æ„å“²å­¦

```
Memos = å¿«é€Ÿæ•è· + æœ¬åœ°å­˜å‚¨ + éšç§ä¼˜å…ˆ
Notion = ç»“æ„åŒ–æ•´ç† + å›¢é˜Ÿåä½œ + äº‘ç«¯åŒæ­¥
çŸ¥è¯†å›¾è°± = å®ä½“å…³è” + è¯­ä¹‰æ£€ç´¢ + æ·±åº¦åˆ†æ
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Memos + Notion çŸ¥è¯†åº“ç³»ç»Ÿ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         æ•°æ®é‡‡é›†å±‚ (5000+/å¤©)                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ GitHub  â”‚ â”‚ Twitter â”‚ â”‚ YouTube â”‚ â”‚  å¾®ä¿¡   â”‚ â”‚  arXiv  â”‚       â”‚   â”‚
â”‚  â”‚  â”‚Trending â”‚ â”‚  çƒ­ç‚¹   â”‚ â”‚  çƒ­é—¨   â”‚ â”‚ å…¬ä¼—å·  â”‚ â”‚  è®ºæ–‡   â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚       â”‚           â”‚           â”‚           â”‚           â”‚             â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚                               â”‚                                      â”‚   â”‚
â”‚  â”‚                               â–¼                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                    n8n å·¥ä½œæµå¼•æ“                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚         (NAS: 192.168.80.2:5678)                            â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚              â–¼                â–¼                â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           å¤„ç†å±‚                                       â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚   æœ¬åœ° LLM      â”‚  â”‚   å†…å®¹åˆ†æå™¨    â”‚  â”‚   Tag ç”Ÿæˆå™¨    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚  (Mac Ollama)   â”‚  â”‚                 â”‚  â”‚                 â”‚       â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚ - æ‘˜è¦ç”Ÿæˆ      â”‚  â”‚ - è‡ªåŠ¨æ ‡ç­¾      â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - Qwen3-14B    â”‚  â”‚ - å…³é”®è¯æå–    â”‚  â”‚ - åˆ†ç±»æ˜ å°„      â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ (é«˜æ€§èƒ½æ¨ç†)   â”‚  â”‚ - æƒ…æ„Ÿåˆ†æ      â”‚  â”‚ - ä¼˜å…ˆçº§è¯„ä¼°    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚               â”‚  â”‚ - ç›¸å…³æ€§è¯„åˆ†    â”‚  â”‚                 â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚              â–¼                â–¼                â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          å­˜å‚¨å±‚                                        â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚     Memos       â”‚  â”‚     Neo4j       â”‚  â”‚     Notion      â”‚       â”‚ â”‚
â”‚  â”‚  â”‚  (NAS Docker)   â”‚  â”‚  (NAS Docker)   â”‚  â”‚    (äº‘ç«¯)       â”‚       â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - å¿«é€Ÿæ•è·      â”‚  â”‚ - å®ä½“å…³ç³»      â”‚  â”‚ - ç»“æ„åŒ–æ•´ç†    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - å…¨æ–‡æœç´¢      â”‚  â”‚ - è¯­ä¹‰æ£€ç´¢      â”‚  â”‚ - å›¢é˜Ÿåä½œ      â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - Tagç³»ç»Ÿ       â”‚  â”‚ - å¤§å®¹é‡å­˜å‚¨    â”‚  â”‚ - å¯è§†åŒ–çœ‹æ¿    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - APIé©±åŠ¨      â”‚  â”‚ - å›¾éå†æŸ¥è¯¢    â”‚  â”‚                 â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â”‚           â”‚                   â”‚                   â”‚                   â”‚ â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â”‚
â”‚  â”‚                               â”‚                                       â”‚ â”‚
â”‚  â”‚                               â–¼                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚                    PostgreSQL                                â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                 (ç»Ÿä¸€å…ƒæ•°æ®å­˜å‚¨)                              â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  - æ–‡ç« å…ƒæ•°æ®ã€åŒæ­¥çŠ¶æ€ã€å¤„ç†è®°å½•ã€ç»Ÿè®¡æ•°æ®                   â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                             â”‚
â”‚                               â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          åº”ç”¨å±‚                                        â”‚ â”‚
â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚  æ¯æ—¥é€‰é¢˜æ¨è   â”‚  â”‚  æ™ºèƒ½æ£€ç´¢åŠ©æ‰‹   â”‚  â”‚  æ–‡ç« ç”Ÿæˆç®¡çº¿   â”‚       â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - çƒ­ç‚¹æ’åº      â”‚  â”‚ - è‡ªç„¶è¯­è¨€æŸ¥è¯¢  â”‚  â”‚ - è‰ç¨¿ç”Ÿæˆ      â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - è¶‹åŠ¿åˆ†æ      â”‚  â”‚ - ç›¸å…³å†…å®¹æ¨è  â”‚  â”‚ - äººæ€§åŒ–ä¼˜åŒ–    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ - 08:00 é€šçŸ¥    â”‚  â”‚ - çŸ¥è¯†å›¾è°±æ£€ç´¢  â”‚  â”‚ - å¤šå¹³å°å‘å¸ƒ    â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„æ ¸å¿ƒè¦ç‚¹

| ç»„ä»¶ | éƒ¨ç½²ä½ç½® | æ ¸å¿ƒèŒè´£ |
|------|----------|----------|
| **n8n** | NAS Docker (5678) | å·¥ä½œæµç¼–æ’ã€ä»»åŠ¡è°ƒåº¦ |
| **Memos** | NAS Docker (5230) | å¿«é€Ÿæ•è·ã€æœ¬åœ°å­˜å‚¨ã€Tagç³»ç»Ÿ |
| **PostgreSQL** | NAS Docker (5432) | ç»Ÿä¸€å…ƒæ•°æ®å­˜å‚¨ |
| **Ollama** | **Macæœ¬æœº (11434)** | æœ¬åœ°LLMæ¨ç† (Qwen3-14B) |
| **Neo4j** | **NAS Docker (7474/7687)** | çŸ¥è¯†å›¾è°±ã€å¤§å®¹é‡å­˜å‚¨ |
| **Notion** | äº‘ç«¯ | ç»“æ„åŒ–æ•´ç†ã€å›¢é˜Ÿåä½œ |

> ğŸ’¡ **è®¾è®¡å†³ç­–**:
> - **Ollama â†’ Mac**: æ¨ç†å¯†é›†å‹ï¼Œéœ€è¦é«˜ç®—åŠ› (Mac M3 50-80 tok/s vs NAS 5-10 tok/s)
> - **Neo4j â†’ NAS**: å­˜å‚¨å¯†é›†å‹ï¼ŒNASå¤§å®¹é‡SSDé€‚åˆå›¾æ•°æ®åº“æŒä¹…åŒ–ï¼Œæ— äº‘ç«¯æˆæœ¬

---

## ğŸ“Š ç»„ä»¶è¯¦ç»†è®¾è®¡

### 1. Memos éƒ¨ç½²é…ç½® (NAS)

```yaml
# /volume1/docker/memos/docker-compose.yml
version: "3.9"

services:
  memos:
    image: neosmemo/memos:stable
    container_name: memos
    restart: unless-stopped
    ports:
      - "5230:5230"
    volumes:
      - ./data:/var/opt/memos
    environment:
      - MEMOS_MODE=prod
      - MEMOS_PORT=5230
      - MEMOS_DRIVER=postgres
      - MEMOS_DSN=postgresql://memos:memos_password@memos-db:5432/memos?sslmode=disable
    depends_on:
      - memos-db
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:5230/api/v1/ping"]
      interval: 30s
      timeout: 10s
      retries: 5

  memos-db:
    image: postgres:16-alpine
    container_name: memos-db
    restart: unless-stopped
    volumes:
      - ./postgres:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: memos
      POSTGRES_PASSWORD: memos_password
      POSTGRES_DB: memos
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U memos -d memos"]
      interval: 30s
      timeout: 10s
      retries: 5

networks:
  default:
    name: knowledge-base
```

### 2. æœ¬åœ° LLM é…ç½® (Mac Ollama)

> âš ï¸ **é‡è¦å˜æ›´**: Ollama éƒ¨ç½²åœ¨ Mac æœ¬æœºï¼ˆéNASï¼‰ï¼Œä½¿ç”¨ Qwen3-14B æ¨¡å‹
> **åŸå› **: NAS (AMD R1600, 32GB RAM) æ€§èƒ½ä¸è¶³ä»¥è¿è¡Œå¤§è§„æ¨¡LLMæ¨ç†

#### 2.1 Mac æœ¬æœºé…ç½®

```yaml
# Mac æœ¬æœº Ollama é…ç½®
host: Mac (M3 Max / 128GB RAM)
ollama_url: http://192.168.80.1:11434  # Mac å†…ç½‘ IP
model: qwen3:14b
performance:
  tokens_per_second: ~50-80 tok/s
  context_length: 32768
  memory_usage: ~12GB
```

#### 2.2 Mac å®‰è£…ä¸é…ç½®

```bash
# 1. å®‰è£… Ollama (å¦‚æœªå®‰è£…)
brew install ollama

# 2. æ‹‰å– Qwen3-14B æ¨¡å‹
ollama pull qwen3:14b

# 3. é…ç½® Ollama ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ï¼ˆå…è®¸NASè®¿é—®ï¼‰
# ç¼–è¾‘ ~/.zshrc æˆ– ~/.bashrc æ·»åŠ ï¼š
export OLLAMA_HOST=0.0.0.0

# 4. å¯åŠ¨ Ollama æœåŠ¡
ollama serve

# 5. éªŒè¯æ¨¡å‹
ollama list
# åº”æ˜¾ç¤º: qwen3:14b

# 6. æµ‹è¯•æ¨ç†
curl http://localhost:11434/api/generate \
  -d '{"model": "qwen3:14b", "prompt": "Hello", "stream": false}'
```

#### 2.3 ç½‘ç»œé…ç½®ï¼ˆNAS è®¿é—® Mac Ollamaï¼‰

```bash
# ç¡®è®¤ Mac IP åœ°å€
ifconfig en0 | grep "inet "
# é¢„æœŸè¾“å‡º: inet 192.168.80.1 netmask...

# NAS è®¿é—®æµ‹è¯•
ssh feng@192.168.80.2
curl http://192.168.80.1:11434/api/tags
# åº”è¿”å›æ¨¡å‹åˆ—è¡¨

# macOS é˜²ç«å¢™é…ç½®ï¼ˆå¦‚éœ€è¦ï¼‰
# System Preferences â†’ Security & Privacy â†’ Firewall â†’ Allow ollama
```

#### 2.4 æ€§èƒ½å¯¹æ¯”

| éƒ¨ç½²æ–¹æ¡ˆ | ç¡¬ä»¶ | Qwen3-14B æ¨ç†é€Ÿåº¦ | é€‚ç”¨åœºæ™¯ |
|----------|------|-------------------|----------|
| **Mac æœ¬æœº** âœ… | M3 Max 128GB | **50-80 tok/s** | æ¨è |
| NAS Docker âŒ | AMD R1600 32GB | ~5-10 tok/s | æ€§èƒ½ä¸è¶³ |
| äº‘ç«¯ API | N/A | å–å†³äºç½‘ç»œ | æˆæœ¬é«˜ã€éšç§é£é™© |

### 3. Neo4j çŸ¥è¯†å›¾è°± (NAS Docker)

> ğŸ’¡ Neo4j æ˜¯å­˜å‚¨å¯†é›†å‹æœåŠ¡ï¼Œé€‚åˆéƒ¨ç½²åœ¨ NAS å¤§å®¹é‡å­˜å‚¨ä¸Šï¼Œæ— éœ€äº‘ç«¯æˆæœ¬

```yaml
# /volume1/docker/neo4j/docker-compose.yml
version: "3.9"

services:
  neo4j:
    image: neo4j:5.15-community
    container_name: neo4j
    restart: unless-stopped
    ports:
      - "7474:7474"   # HTTP Browser
      - "7687:7687"   # Bolt protocol
    volumes:
      - ./data:/data
      - ./logs:/logs
      - ./plugins:/plugins
    environment:
      - NEO4J_AUTH=neo4j/knowledge_graph_2026
      - NEO4J_PLUGINS=["apoc"]
      - NEO4J_dbms_memory_pagecache_size=2G
      - NEO4J_dbms_memory_heap_initial__size=1G
      - NEO4J_dbms_memory_heap_max__size=2G
      # å…è®¸å¤–éƒ¨è®¿é—®
      - NEO4J_dbms_connector_bolt_listen__address=0.0.0.0:7687
      - NEO4J_dbms_connector_http_listen__address=0.0.0.0:7474
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:7474"]
      interval: 30s
      timeout: 10s
      retries: 5

networks:
  default:
    name: knowledge-base
```

#### 3.1 Neo4j è®¿é—®ä¿¡æ¯

| é¡¹ç›® | å€¼ |
|------|-----|
| **Browser URL** | http://192.168.80.2:7474 |
| **Bolt URL** | bolt://192.168.80.2:7687 |
| **ç”¨æˆ·å** | neo4j |
| **å¯†ç ** | knowledge_graph_2026 |

#### 3.2 Python è¿æ¥ç¤ºä¾‹

```python
from neo4j import GraphDatabase

driver = GraphDatabase.driver(
    "bolt://192.168.80.2:7687",
    auth=("neo4j", "knowledge_graph_2026")
)

# åˆ›å»ºæ–‡ç« èŠ‚ç‚¹
def create_article(tx, article):
    tx.run("""
        MERGE (a:Article {id: $id})
        SET a.title = $title,
            a.summary = $summary,
            a.source = $source,
            a.hot_score = $hot_score,
            a.created_at = datetime()
    """, **article)

# å»ºç«‹ä¸»é¢˜å…³è”
def link_to_topic(tx, article_id, topic_name):
    tx.run("""
        MATCH (a:Article {id: $article_id})
        MERGE (t:Topic {name: $topic_name})
        MERGE (a)-[:ABOUT]->(t)
    """, article_id=article_id, topic_name=topic_name)
```

### 4. æ•°æ®æ¨¡å‹è®¾è®¡

#### 3.1 PostgreSQL Schema (ç»Ÿä¸€å…ƒæ•°æ®)

```sql
-- æ–‡ç« å…ƒæ•°æ®è¡¨
CREATE TABLE articles (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    source VARCHAR(50) NOT NULL,  -- github, twitter, youtube, wechat, arxiv
    source_id VARCHAR(255) NOT NULL,
    title TEXT NOT NULL,
    content TEXT,
    summary TEXT,  -- LLMç”Ÿæˆçš„æ‘˜è¦
    url TEXT,
    author VARCHAR(255),

    -- å¤„ç†çŠ¶æ€
    memos_id VARCHAR(50),  -- Memosä¸­çš„ID
    notion_page_id VARCHAR(50),  -- Notionä¸­çš„é¡µé¢ID
    neo4j_node_id VARCHAR(50),  -- Neo4jä¸­çš„èŠ‚ç‚¹ID

    -- åˆ†æç»“æœ
    keywords JSONB,  -- å…³é”®è¯æ•°ç»„
    tags VARCHAR(100)[],  -- æ ‡ç­¾æ•°ç»„
    hot_score FLOAT,  -- çƒ­åº¦è¯„åˆ†
    relevance_score FLOAT,  -- ç›¸å…³æ€§è¯„åˆ†
    sentiment VARCHAR(20),  -- æƒ…æ„Ÿåˆ†æ

    -- æ—¶é—´æˆ³
    source_created_at TIMESTAMPTZ,
    collected_at TIMESTAMPTZ DEFAULT NOW(),
    processed_at TIMESTAMPTZ,
    synced_to_memos_at TIMESTAMPTZ,
    synced_to_notion_at TIMESTAMPTZ,

    -- å”¯ä¸€çº¦æŸ
    UNIQUE(source, source_id)
);

-- ç´¢å¼•
CREATE INDEX idx_articles_source ON articles(source);
CREATE INDEX idx_articles_tags ON articles USING GIN(tags);
CREATE INDEX idx_articles_hot_score ON articles(hot_score DESC);
CREATE INDEX idx_articles_collected_at ON articles(collected_at DESC);

-- åŒæ­¥çŠ¶æ€è¡¨
CREATE TABLE sync_status (
    id SERIAL PRIMARY KEY,
    article_id UUID REFERENCES articles(id),
    target VARCHAR(20) NOT NULL,  -- memos, notion, neo4j
    status VARCHAR(20) NOT NULL,  -- pending, success, failed
    error_message TEXT,
    retry_count INT DEFAULT 0,
    last_attempt_at TIMESTAMPTZ,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- å¤„ç†æ—¥å¿—è¡¨
CREATE TABLE processing_logs (
    id SERIAL PRIMARY KEY,
    article_id UUID REFERENCES articles(id),
    processor VARCHAR(50) NOT NULL,  -- llm_summary, keyword_extract, tag_generate
    input_tokens INT,
    output_tokens INT,
    duration_ms INT,
    result JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### 3.2 Memos Tag ä½“ç³»

```yaml
# Tagå‘½åè§„èŒƒ
tag_structure:
  # æ¥æºæ ‡ç­¾
  source:
    - "#source/github"
    - "#source/twitter"
    - "#source/youtube"
    - "#source/wechat"
    - "#source/arxiv"

  # ä¸»é¢˜åˆ†ç±»
  topic:
    - "#topic/ai-security"
    - "#topic/llm"
    - "#topic/vulnerability"
    - "#topic/apt"
    - "#topic/threat-intel"
    - "#topic/devsecops"

  # ä¼˜å…ˆçº§
  priority:
    - "#priority/high"
    - "#priority/medium"
    - "#priority/low"

  # å¤„ç†çŠ¶æ€
  status:
    - "#status/unread"
    - "#status/read"
    - "#status/processed"
    - "#status/published"

  # æ—¶é—´æ ‡ç­¾
  time:
    - "#time/2026-01"
    - "#time/week-02"
```

#### 3.3 Neo4j çŸ¥è¯†å›¾è°±æ¨¡å‹

```cypher
// èŠ‚ç‚¹ç±»å‹
(:Article {
  id: string,
  title: string,
  summary: string,
  url: string,
  source: string,
  hot_score: float,
  created_at: datetime
})

(:Topic {
  name: string,
  description: string
})

(:Author {
  name: string,
  platform: string,
  profile_url: string
})

(:Technology {
  name: string,
  category: string  // language, framework, tool
})

(:Vulnerability {
  cve_id: string,
  severity: string,
  cvss: float
})

(:APTGroup {
  name: string,
  aliases: list<string>,
  country: string
})

// å…³ç³»ç±»å‹
(:Article)-[:ABOUT]->(:Topic)
(:Article)-[:WRITTEN_BY]->(:Author)
(:Article)-[:MENTIONS]->(:Technology)
(:Article)-[:DISCUSSES]->(:Vulnerability)
(:Article)-[:TRACKS]->(:APTGroup)
(:Article)-[:RELATED_TO]->(:Article)
```

---

## ğŸ”„ n8n å·¥ä½œæµè®¾è®¡

### 4.1 ä¸»å·¥ä½œæµ: æ–‡ç« é‡‡é›†å…¥åº“

```yaml
workflow_name: "Knowledge Base - Article Ingestion"
schedule: "*/30 * * * *"  # æ¯30åˆ†é’Ÿ

nodes:
  - trigger:
      type: n8n-nodes-base.scheduleTrigger
      interval: 30 minutes

  - collect_github:
      type: n8n-nodes-base.httpRequest
      url: "http://pubilie-api:8000/api/v1/collectors/github/trending"

  - collect_twitter:
      type: n8n-nodes-base.httpRequest
      url: "http://pubilie-api:8000/api/v1/collectors/twitter/monitor"

  - merge_results:
      type: n8n-nodes-base.merge
      mode: append

  - filter_duplicates:
      type: n8n-nodes-base.code
      code: |
        // æ ¹æ®source_idå»é‡
        const seen = new Set();
        return $input.all().filter(item => {
          const key = `${item.json.source}:${item.json.source_id}`;
          if (seen.has(key)) return false;
          seen.add(key);
          return true;
        });

  - process_with_llm:
      type: n8n-nodes-base.httpRequest
      url: "http://192.168.80.1:11434/api/generate"  # Mac Ollama
      method: POST
      body: |
        {
          "model": "qwen3:14b",
          "prompt": "è¯·ä¸ºä»¥ä¸‹å†…å®¹ç”Ÿæˆ100å­—æ‘˜è¦å’Œ5ä¸ªå…³é”®è¯...",
          "stream": false
        }

  - save_to_memos:
      type: n8n-nodes-memos.createMemo
      url: "http://memos:5230"
      content: "{{ $json.title }}\n\n{{ $json.summary }}\n\n{{ $json.tags.join(' ') }}"

  - save_to_postgres:
      type: n8n-nodes-base.postgres
      operation: insert
      table: articles

  - update_neo4j:
      type: n8n-nodes-base.httpRequest
      url: "http://neo4j:7474/db/data/cypher"
```

### 4.2 æ¯æ—¥é€‰é¢˜ç”Ÿæˆå·¥ä½œæµ

```yaml
workflow_name: "Knowledge Base - Daily Topic Generation"
schedule: "0 7 * * *"  # æ¯å¤©07:00

nodes:
  - trigger:
      type: n8n-nodes-base.scheduleTrigger
      time: "07:00"

  - fetch_yesterday_articles:
      type: n8n-nodes-base.postgres
      query: |
        SELECT * FROM articles
        WHERE collected_at > NOW() - INTERVAL '24 hours'
        ORDER BY hot_score DESC
        LIMIT 100

  - analyze_trends:
      type: n8n-nodes-base.httpRequest
      url: "http://192.168.80.1:11434/api/generate"  # Mac Ollama
      body: |
        {
          "model": "qwen3:14b",
          "prompt": "åˆ†æä»¥ä¸‹100æ¡çƒ­ç‚¹ï¼Œç”Ÿæˆ10ä¸ªé€‰é¢˜å»ºè®®..."
        }

  - generate_drafts:
      type: n8n-nodes-base.code
      code: |
        // ç”Ÿæˆé€‰é¢˜è‰ç¨¿æ¡†æ¶
        const topics = $input.first().json.topics;
        return topics.map(topic => ({
          json: {
            title: topic.title,
            outline: topic.outline,
            references: topic.sources,
            estimated_words: 2000
          }
        }));

  - save_to_notion:
      type: n8n-nodes-base.notion
      operation: createPage
      database_id: "{{ $env.NOTION_TOPICS_DB }}"

  - notify_telegram:
      type: n8n-nodes-base.telegram
      chatId: "{{ $env.TELEGRAM_CHAT_ID }}"
      text: |
        ğŸ“° æ¯æ—¥é€‰é¢˜æ¨è ({{ $today }})

        {{ $json.topics.map((t, i) => `${i+1}. ${t.title}`).join('\n') }}

        è¯¦æƒ…æŸ¥çœ‹ Notion ğŸ‘‰ [é“¾æ¥]
```

### 4.3 Memos åˆ° Notion åŒæ­¥å·¥ä½œæµ

```yaml
workflow_name: "Knowledge Base - Memos to Notion Sync"
schedule: "0 */2 * * *"  # æ¯2å°æ—¶

nodes:
  - trigger:
      type: n8n-nodes-base.scheduleTrigger
      interval: 2 hours

  - fetch_unsynced_memos:
      type: n8n-nodes-memos.searchMemos
      url: "http://memos:5230"
      filter: "#status/processed -#synced/notion"

  - transform_for_notion:
      type: n8n-nodes-base.code
      code: |
        return $input.all().map(memo => ({
          json: {
            title: memo.json.content.split('\n')[0].substring(0, 100),
            content: memo.json.content,
            tags: extractTags(memo.json.content),
            source_url: memo.json.resource?.url,
            created_at: memo.json.createdAt
          }
        }));

  - create_notion_page:
      type: n8n-nodes-base.notion
      operation: createPage
      database_id: "{{ $env.NOTION_KNOWLEDGE_DB }}"
      properties:
        Title: "{{ $json.title }}"
        Tags: "{{ $json.tags }}"
        Source: "{{ $json.source_url }}"

  - update_memos_tag:
      type: n8n-nodes-memos.updateMemo
      addTags: ["#synced/notion"]
```

---

## ğŸ§  æœ¬åœ° LLM å¤„ç†ç®¡çº¿

### 5.1 å¤„ç†æµç¨‹

```python
# automation/processors/llm_processor.py
from typing import Optional
import httpx
from pydantic import BaseModel

class LLMProcessor:
    """æœ¬åœ°LLMå¤„ç†å™¨ - åŸºäºMac Ollama (Qwen3-14B)"""

    def __init__(self, base_url: str = "http://192.168.80.1:11434"):
        self.base_url = base_url
        self.default_model = "qwen3:14b"

    async def generate_summary(
        self,
        content: str,
        max_length: int = 100
    ) -> str:
        """ç”Ÿæˆæ–‡ç« æ‘˜è¦"""
        prompt = f"""è¯·ä¸ºä»¥ä¸‹å†…å®¹ç”Ÿæˆä¸€ä¸ª{max_length}å­—ä»¥å†…çš„ä¸­æ–‡æ‘˜è¦ï¼Œ
è¦æ±‚ï¼šç®€æ´ã€å‡†ç¡®ã€çªå‡ºæ ¸å¿ƒè§‚ç‚¹ã€‚

å†…å®¹ï¼š
{content[:3000]}

æ‘˜è¦ï¼š"""

        response = await self._generate(prompt)
        return response.strip()

    async def extract_keywords(
        self,
        content: str,
        count: int = 5
    ) -> list[str]:
        """æå–å…³é”®è¯"""
        prompt = f"""è¯·ä»ä»¥ä¸‹å†…å®¹ä¸­æå–{count}ä¸ªæœ€é‡è¦çš„å…³é”®è¯ã€‚
ä»…è¿”å›å…³é”®è¯ï¼Œç”¨é€—å·åˆ†éš”ã€‚

å†…å®¹ï¼š
{content[:3000]}

å…³é”®è¯ï¼š"""

        response = await self._generate(prompt)
        keywords = [k.strip() for k in response.split(',')]
        return keywords[:count]

    async def classify_topic(
        self,
        content: str
    ) -> list[str]:
        """åˆ†ç±»ä¸»é¢˜æ ‡ç­¾"""
        topics = [
            "ai-security", "llm", "vulnerability", "apt",
            "threat-intel", "devsecops", "cloud-security",
            "web3", "mobile-security", "red-team"
        ]

        prompt = f"""æ ¹æ®ä»¥ä¸‹å†…å®¹ï¼Œä»ç»™å®šçš„ä¸»é¢˜åˆ—è¡¨ä¸­é€‰æ‹©æœ€åŒ¹é…çš„1-3ä¸ªä¸»é¢˜ã€‚

å¯é€‰ä¸»é¢˜ï¼š{', '.join(topics)}

å†…å®¹ï¼š
{content[:2000]}

é€‰æ‹©çš„ä¸»é¢˜ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼š"""

        response = await self._generate(prompt)
        selected = [t.strip() for t in response.split(',')]
        return [t for t in selected if t in topics]

    async def assess_relevance(
        self,
        content: str,
        target_topics: list[str]
    ) -> float:
        """è¯„ä¼°å†…å®¹ç›¸å…³æ€§ï¼ˆ0-1ï¼‰"""
        prompt = f"""è¯„ä¼°ä»¥ä¸‹å†…å®¹ä¸ç›®æ ‡ä¸»é¢˜çš„ç›¸å…³ç¨‹åº¦ã€‚
è¿”å›0-1ä¹‹é—´çš„åˆ†æ•°ï¼Œ1è¡¨ç¤ºé«˜åº¦ç›¸å…³ã€‚

ç›®æ ‡ä¸»é¢˜ï¼š{', '.join(target_topics)}

å†…å®¹ï¼š
{content[:2000]}

ç›¸å…³æ€§åˆ†æ•°ï¼ˆä»…è¿”å›æ•°å­—ï¼‰ï¼š"""

        response = await self._generate(prompt)
        try:
            score = float(response.strip())
            return min(max(score, 0), 1)
        except ValueError:
            return 0.5

    async def _generate(
        self,
        prompt: str,
        model: Optional[str] = None
    ) -> str:
        """è°ƒç”¨Ollama API"""
        async with httpx.AsyncClient(timeout=60.0) as client:
            response = await client.post(
                f"{self.base_url}/api/generate",
                json={
                    "model": model or self.default_model,
                    "prompt": prompt,
                    "stream": False
                }
            )
            response.raise_for_status()
            return response.json()["response"]
```

### 5.2 æ‰¹é‡å¤„ç†ä»»åŠ¡

```python
# automation/tasks/batch_processor.py
import asyncio
from automation.processors.llm_processor import LLMProcessor
from automation.storage.memos_client import MemosClient
from automation.storage.pg_store import PostgresStore

class BatchProcessor:
    """æ‰¹é‡æ–‡ç« å¤„ç†ä»»åŠ¡"""

    def __init__(self):
        self.llm = LLMProcessor()
        self.memos = MemosClient("http://memos:5230")
        self.pg = PostgresStore()

    async def process_batch(self, batch_size: int = 50):
        """å¤„ç†ä¸€æ‰¹å¾…å¤„ç†æ–‡ç« """
        # è·å–å¾…å¤„ç†æ–‡ç« 
        articles = await self.pg.get_pending_articles(limit=batch_size)

        # å¹¶å‘å¤„ç†
        tasks = [self.process_article(article) for article in articles]
        results = await asyncio.gather(*tasks, return_exceptions=True)

        # ç»Ÿè®¡ç»“æœ
        success = sum(1 for r in results if not isinstance(r, Exception))
        failed = len(results) - success

        return {"processed": success, "failed": failed}

    async def process_article(self, article: dict):
        """å¤„ç†å•ç¯‡æ–‡ç« """
        content = article["content"] or article["title"]

        # 1. ç”Ÿæˆæ‘˜è¦
        summary = await self.llm.generate_summary(content)

        # 2. æå–å…³é”®è¯
        keywords = await self.llm.extract_keywords(content)

        # 3. åˆ†ç±»ä¸»é¢˜
        topics = await self.llm.classify_topic(content)

        # 4. è¯„ä¼°ç›¸å…³æ€§
        relevance = await self.llm.assess_relevance(
            content,
            ["ai-security", "llm", "vulnerability"]
        )

        # 5. æ„å»ºMemoså†…å®¹
        tags = [
            f"#source/{article['source']}",
            f"#priority/{'high' if relevance > 0.7 else 'medium' if relevance > 0.4 else 'low'}",
            "#status/unread"
        ] + [f"#topic/{t}" for t in topics]

        memo_content = f"""## {article['title']}

{summary}

**å…³é”®è¯**: {', '.join(keywords)}
**æ¥æº**: {article['url']}
**é‡‡é›†æ—¶é—´**: {article['collected_at']}

{' '.join(tags)}"""

        # 6. ä¿å­˜åˆ°Memos
        memo_id = await self.memos.create_memo(memo_content)

        # 7. æ›´æ–°PostgreSQL
        await self.pg.update_article(
            article["id"],
            {
                "summary": summary,
                "keywords": keywords,
                "tags": topics,
                "relevance_score": relevance,
                "memos_id": memo_id,
                "processed_at": "NOW()"
            }
        )

        return {"id": article["id"], "memo_id": memo_id}
```

---

## ğŸ“¡ API æ¥å£è®¾è®¡

### 6.1 Memos REST API å°è£…

```python
# automation/storage/memos_client.py
import httpx
from typing import Optional, List

class MemosClient:
    """Memos APIå®¢æˆ·ç«¯"""

    def __init__(self, base_url: str, access_token: Optional[str] = None):
        self.base_url = base_url.rstrip('/')
        self.access_token = access_token
        self.headers = {
            "Authorization": f"Bearer {access_token}" if access_token else ""
        }

    async def create_memo(
        self,
        content: str,
        visibility: str = "PRIVATE"
    ) -> str:
        """åˆ›å»ºMemo"""
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.base_url}/api/v1/memos",
                headers=self.headers,
                json={
                    "content": content,
                    "visibility": visibility
                }
            )
            response.raise_for_status()
            return response.json()["name"].split("/")[-1]

    async def search_memos(
        self,
        filter_expr: str,
        limit: int = 50
    ) -> List[dict]:
        """æœç´¢Memos"""
        async with httpx.AsyncClient() as client:
            response = await client.get(
                f"{self.base_url}/api/v1/memos",
                headers=self.headers,
                params={
                    "filter": filter_expr,
                    "pageSize": limit
                }
            )
            response.raise_for_status()
            return response.json().get("memos", [])

    async def update_memo(
        self,
        memo_id: str,
        content: Optional[str] = None,
        add_tags: Optional[List[str]] = None
    ) -> dict:
        """æ›´æ–°Memo"""
        memo = await self.get_memo(memo_id)

        if add_tags:
            current_content = memo["content"]
            new_tags = " ".join(add_tags)
            content = f"{current_content}\n{new_tags}"

        async with httpx.AsyncClient() as client:
            response = await client.patch(
                f"{self.base_url}/api/v1/memos/{memo_id}",
                headers=self.headers,
                json={"content": content}
            )
            response.raise_for_status()
            return response.json()

    async def get_memo(self, memo_id: str) -> dict:
        """è·å–å•ä¸ªMemo"""
        async with httpx.AsyncClient() as client:
            response = await client.get(
                f"{self.base_url}/api/v1/memos/{memo_id}",
                headers=self.headers
            )
            response.raise_for_status()
            return response.json()
```

### 6.2 ç»Ÿä¸€æŸ¥è¯¢æ¥å£

```python
# automation/api/routes/knowledge.py
from fastapi import APIRouter, Query
from typing import Optional, List

router = APIRouter(prefix="/api/v1/knowledge", tags=["knowledge"])

@router.get("/search")
async def search_knowledge(
    query: str,
    sources: Optional[List[str]] = Query(default=None),
    topics: Optional[List[str]] = Query(default=None),
    min_relevance: float = 0.5,
    limit: int = 20
):
    """
    ç»Ÿä¸€çŸ¥è¯†æ£€ç´¢æ¥å£

    æ”¯æŒï¼š
    - å…¨æ–‡æœç´¢ï¼ˆMemosï¼‰
    - è¯­ä¹‰æ£€ç´¢ï¼ˆNeo4jï¼‰
    - ç»“æ„åŒ–è¿‡æ»¤ï¼ˆPostgreSQLï¼‰
    """
    results = []

    # 1. PostgreSQL ç»“æ„åŒ–æŸ¥è¯¢
    pg_results = await pg_store.search(
        query=query,
        sources=sources,
        topics=topics,
        min_relevance=min_relevance,
        limit=limit
    )
    results.extend(pg_results)

    # 2. Memos å…¨æ–‡æœç´¢
    memos_results = await memos_client.search_memos(
        filter_expr=f'content ~ "{query}"',
        limit=limit
    )

    # 3. Neo4j å›¾æ£€ç´¢ï¼ˆç›¸å…³æ–‡ç« æ¨èï¼‰
    related = await neo4j_store.find_related(
        keywords=query.split(),
        limit=10
    )

    return {
        "results": results,
        "memos_count": len(memos_results),
        "related_articles": related
    }

@router.get("/stats")
async def get_knowledge_stats():
    """è·å–çŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯"""
    return {
        "total_articles": await pg_store.count_articles(),
        "today_collected": await pg_store.count_today(),
        "by_source": await pg_store.count_by_source(),
        "by_topic": await pg_store.count_by_topic(),
        "pending_sync": await pg_store.count_pending_sync()
    }
```

---

## ğŸ“ˆ ç›‘æ§ä¸å‘Šè­¦

### 7.1 å¥åº·æ£€æŸ¥

```yaml
# n8nå·¥ä½œæµ: Knowledge Base Health Check
schedule: "*/5 * * * *"  # æ¯5åˆ†é’Ÿ

checks:
  - name: Memos API
    url: http://memos:5230/api/v1/ping
    expected_status: 200

  - name: Mac Ollama Service
    url: http://192.168.80.1:11434/api/tags
    expected_status: 200
    description: Macæœ¬æœºOllama (Qwen3-14B)

  - name: PostgreSQL
    command: pg_isready -h postgres -p 5432

  - name: Neo4j (NAS)
    url: http://192.168.80.2:7474/
    expected_status: 200
    description: NASæœ¬åœ°çŸ¥è¯†å›¾è°±

alerts:
  - type: telegram
    on: failure
    message: "âš ï¸ çŸ¥è¯†åº“æœåŠ¡å¼‚å¸¸: {{ $json.failed_checks }}"
```

### 7.2 æ€§èƒ½æŒ‡æ ‡

```python
# automation/monitoring/metrics.py
from prometheus_client import Counter, Histogram, Gauge

# é‡‡é›†æŒ‡æ ‡
articles_collected = Counter(
    'knowledge_articles_collected_total',
    'Total articles collected',
    ['source']
)

# å¤„ç†æŒ‡æ ‡
processing_duration = Histogram(
    'knowledge_processing_duration_seconds',
    'Article processing duration',
    ['processor']
)

# åŒæ­¥æŒ‡æ ‡
sync_status = Gauge(
    'knowledge_sync_pending_count',
    'Pending sync count',
    ['target']
)

# LLMæŒ‡æ ‡
llm_tokens_used = Counter(
    'knowledge_llm_tokens_total',
    'Total LLM tokens used',
    ['model', 'operation']
)
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### Phase 1: åŸºç¡€è®¾æ–½ (Day 1)

```bash
# ===== NAS éƒ¨ç½² Memos =====
ssh feng@192.168.80.2
cd /volume1/docker
mkdir -p memos && cd memos
# ä¸Šä¼ docker-compose.yml
docker-compose up -d

# éªŒè¯Memos
curl http://localhost:5230/api/v1/ping

# ===== NAS éƒ¨ç½² Neo4j =====
cd /volume1/docker
mkdir -p neo4j && cd neo4j
# ä¸Šä¼ docker-compose.yml
docker-compose up -d

# éªŒè¯Neo4j (ç­‰å¾…30ç§’å¯åŠ¨)
sleep 30
curl http://localhost:7474/
# è®¿é—® Browser: http://192.168.80.2:7474

# ===== Mac é…ç½® Ollama (æœ¬æœºæ‰§è¡Œ) =====
# åœ¨ Mac æœ¬æœºç»ˆç«¯æ‰§è¡Œ

# 1. å®‰è£… Ollama (å¦‚æœªå®‰è£…)
brew install ollama

# 2. é…ç½®ç›‘å¬æ‰€æœ‰æ¥å£ï¼ˆå…è®¸NASè®¿é—®ï¼‰
echo 'export OLLAMA_HOST=0.0.0.0' >> ~/.zshrc
source ~/.zshrc

# 3. æ‹‰å– Qwen3-14B æ¨¡å‹
ollama pull qwen3:14b

# 4. å¯åŠ¨æœåŠ¡ï¼ˆå»ºè®®ä½¿ç”¨ launchd æˆ– tmux ä¿æŒè¿è¡Œï¼‰
ollama serve

# 5. éªŒè¯æœåŠ¡
curl http://localhost:11434/api/tags

# ===== ä» NAS æµ‹è¯• Mac Ollama è¿é€šæ€§ =====
ssh feng@192.168.80.2
curl http://192.168.80.1:11434/api/tags
# åº”è¿”å› qwen3:14b æ¨¡å‹ä¿¡æ¯
```

### Phase 2: æ•°æ®åº“è¿ç§» (Day 2)

```bash
# 1. åˆ›å»ºPostgreSQLè¡¨
docker exec -i n8n-postgres psql -U n8n -d n8n < schema.sql

# 2. é…ç½®n8nå‡­æ®
# - Memos API Token
# - Notion Integration Token
# - Ollama endpoint

# 3. å¯¼å…¥n8nå·¥ä½œæµ
curl -X POST http://192.168.80.2:5678/api/v1/workflows \
  -H "Authorization: Bearer $N8N_API_KEY" \
  -H "Content-Type: application/json" \
  -d @workflows/article_ingestion.json
```

### Phase 3: é›†æˆæµ‹è¯• (Day 3)

```bash
# 1. æµ‹è¯•é‡‡é›†ç®¡çº¿
curl http://localhost:8000/api/v1/collectors/github/trending

# 2. æµ‹è¯•LLMå¤„ç† (ä»NASè®¿é—®Mac Ollama)
curl -X POST http://192.168.80.1:11434/api/generate \
  -d '{"model":"qwen3:14b","prompt":"Hello","stream":false}'

# 3. æµ‹è¯•Memosåˆ›å»º
curl -X POST http://localhost:5230/api/v1/memos \
  -H "Authorization: Bearer $MEMOS_TOKEN" \
  -d '{"content":"æµ‹è¯•Memo #test"}'

# 4. ç«¯åˆ°ç«¯æµ‹è¯•
python -m pytest tests/integration/test_knowledge_base.py
```

---

## ğŸ“Š é¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | ç›®æ ‡ | éªŒè¯æ–¹å¼ |
|------|------|----------|
| æ¯æ—¥å…¥åº“é‡ | 5000+ æ–‡ç«  | PostgreSQL count |
| å¤„ç†å»¶è¿Ÿ | <5åˆ†é’Ÿ | é‡‡é›†â†’å…¥åº“æ—¶é—´å·® |
| æŸ¥è¯¢å“åº” | <100ms | API ç›‘æ§ |
| LLMå¤„ç†æˆæœ¬ | $0 (æœ¬åœ°) | æ— äº‘ç«¯è°ƒç”¨ |
| å­˜å‚¨å¢é•¿ | ~1GB/æœˆ | ç£ç›˜ç›‘æ§ |
| åŒæ­¥æˆåŠŸç‡ | >99% | åŒæ­¥çŠ¶æ€ç»Ÿè®¡ |

---

## ğŸ“ ç›¸å…³èµ„æº

### å‚è€ƒæ–‡æ¡£
- [Memos API æ–‡æ¡£](https://www.usememos.com/docs/api/overview)
- [Ollama API å‚è€ƒ](https://github.com/ollama/ollama/blob/main/docs/api.md)
- [n8n Memos ç¤¾åŒºèŠ‚ç‚¹](https://www.npmjs.com/package/n8n-nodes-memos)

### é…ç½®æ–‡ä»¶ä½ç½®
- Memos (NAS): `/volume1/docker/memos/docker-compose.yml`
- Neo4j (NAS): `/volume1/docker/neo4j/docker-compose.yml`
- Ollama (Mac): `~/.ollama/` (æ¨¡å‹å­˜å‚¨)
- Ollama ç¯å¢ƒ: `~/.zshrc` (OLLAMA_HOST=0.0.0.0)
- n8nå·¥ä½œæµ: `/volume1/docker/n8n/workflows/`

### ç›¸å…³é¡¹ç›®
- pubilie_doc: `/Users/anwu/Documents/code/pubilie_doc/`
- NotionåŒæ­¥å·¥å…·: `~/Documents/code/tools/notion-archive/`

---

**åˆ›å»ºæ—¶é—´**: 2026-01-13 21:00:00 +0800
**æ›´æ–°æ—¶é—´**: 2026-01-13 21:30:00 +0800
**è®¾è®¡è€…**: Claude Opus 4.5 (Ultrathink Protocol v2.7)
**çŠ¶æ€**: è®¾è®¡å®Œæˆï¼Œå¾…å®æ–½
**æ¶æ„å˜æ›´**:
- Ollama: NAS Docker â†’ Mac æœ¬æœº (Qwen3-14Bï¼Œæ€§èƒ½ä¼˜åŒ–)
- Neo4j: äº‘ç«¯ Aura â†’ NAS Docker (å¤§å®¹é‡å­˜å‚¨ï¼Œé›¶æˆæœ¬)
